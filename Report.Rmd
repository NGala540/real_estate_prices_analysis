---
title: "Main report"
author: "Stanislav Kohnovsky"
date: "2024-12-18"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Service section

```{r libraries, include=FALSE}
if(!require("dplyr")) package.import("dplyr")
if(!require("naniar")) package.import("naniar")
if(!require("finalfit")) package.import("finalfit")
if(!require("lubridate")) package.import("lubridate")
library(dplyr)
# install.packages("finalfit")
library("naniar")
library("finalfit")
library("lubridate")
```

## Data import

```{r import}
get_data <- function (path, files) {
  complete_data <- c()
  month <-  as.Date("2023-09-01", format="%Y-%m-%d")
  for (file in files) {
    data_f <- read.csv(file=paste(path, "\\", file, sep=""), encoding ="UTF-8", header=TRUE, sep = ",")
    data_f$period <- month
    month <- month %m+% months(1)
    complete_data <- complete_data %>% 
      bind_rows(data_f)
  }
  return(complete_data)
}

path_to_source_data <- ".\\analiza_danych_projekt_zespolowy\\Nieruchomosci w Polsce"
list_of_files = list.files(path_to_source_data, pattern="^apartments_pl_.*\\.csv")
data <- get_data(path_to_source_data, list_of_files)

summary(data$period)

# attach(dane)
```

## Missing observations

```{r libraries, include=FALSE}
if(!require("naniar")) package.import("naniar")
library(naniar)
```

```{r missed}
print(paste("Number of missing observations is", sum(is.na(data))))
print("Percentage of missing values in each column")
sapply(data, function(x) mean(is.na(x)) * 100)
miss_var_summary(data)
data %>% 
  group_by(period) %>% 
  miss_var_summary()
miss_case_summary(data)
# Visualize missing data
vis_miss(filter(data, period == as.Date("2023-09-01")))
vis_miss(filter(data, period == as.Date("2023-10-01")))
vis_miss(filter(data, period == as.Date("2023-11-01")))
vis_miss(filter(data, period == as.Date("2023-12-01")))
vis_miss(filter(data, period == as.Date("2024-01-01")))
vis_miss(filter(data, period == as.Date("2024-02-01")))
vis_miss(filter(data, period == as.Date("2024-03-01")))
vis_miss(filter(data, period == as.Date("2024-04-01")))
vis_miss(filter(data, period == as.Date("2024-05-01")))
vis_miss(filter(data, period == as.Date("2024-06-01")))

```

```{r missed-whole-set}

data %>%
  missing_plot()
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
